# Week 02. React Task (Slurm –ù–∞–≤—ã–∫—É–º "Build Containers!")

## –ó–∞–¥–∞—á–∞

–ï—Å—Ç—å –ø—Ä–æ–µ–∫—Ç –Ω–∞ React (–∏—Å—Ö–æ–¥–Ω–∏–∫–∏ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ —ç—Ç–æ–º –∫–∞—Ç–∞–ª–æ–≥–µ), –∫–æ—Ç–æ—Ä—ã–π –ø—Ä–µ–¥—Å—Ç–∞–≤–ª—è–µ—Ç —Å–æ–±–æ–π Frontend –∫ –æ–¥–Ω–æ–º—É –∏–∑ –≤–µ–±-—Å–µ—Ä–≤–∏—Å–æ–≤

–¢–∞–∫ –ø–æ–ª—É—á–∏–ª–æ—Å—å, —á—Ç–æ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∑–∞–ø–∏–ª–∏–ª–∏ Frontend —Ä–∞–Ω—å—à–µ, —á–µ–º Backend, –ø–æ—ç—Ç–æ–º—É Backend'–µ—Ä–∞–º –Ω—É–∂–Ω–æ –ø–∏–ª–∏—Ç—å –∏ —Å–≤–æ—é —á–∞—Å—Ç—å, –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –≤—Å—ë –≤–º–µ—Å—Ç–µ

–ü–æ—ç—Ç–æ–º—É –æ–Ω–∏ (Backend'–µ—Ä—ã) –ø—Ä–æ—Å—è—Ç –Ω–∞—Å —É–ø–∞–∫–æ–≤–∞—Ç—å Frontend –≤ Docker-–æ–±—Ä–∞–∑, –∏—Å–ø–æ–ª—å–∑—É—è –≤ –∫–∞—á–µ—Å—Ç–≤–µ –±–∞–∑—ã –∫–æ–Ω–µ—á–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ [Nginx](https://hub.docker.com/_/nginx) –≤–µ—Ä—Å–∏–∏ 1.22 (alpine)

–î–ª—è –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö —ç—Ç–∞–ø–æ–≤ (—Å–±–æ—Ä–∫–∞) –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å [Node Alpine LTS](https://hub.docker.com/_/node)

### –§–æ—Ä–º—É–ª–∏—Ä–æ–≤–∫–∞ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–∞

–†–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫ —Å–∫–∞–∑–∞–ª —Å–ª–µ–¥—É—é—â–µ–µ* (–¥–æ—Å–ª–æ–≤–Ω–æ):
> Frontend –¥–µ–ª–∞–µ—Ç –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ `/api`, –ø–æ—ç—Ç–æ–º—É –Ω—É–∂–Ω–æ, —á—Ç–æ–±—ã –¥–∞–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø—Ä–æ–∫—Å–∏—Ä–æ–≤–∞–ª–∏—Å—å Nginx'–æ–º –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—É—é –º–∞—à–∏–Ω—É, –ø–æ—Ä—Ç `9999` (–∏–º–µ–Ω–Ω–æ —Ç–∞–º –≤ —Å—Ä–µ–¥–µ —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –±—É–¥–µ—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —Å–µ—Ä–≤–µ—Ä, –∫–æ—Ç–æ—Ä—ã–π –º—ã –∏ —Ä–∞–∑—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º)
>
> –ü—Ä–∏ —ç—Ç–æ–º, –≤–æ–∑–º–æ–∂–Ω–æ, —É Docker –µ—Å—Ç—å –∫–∞–∫–æ–µ-—Ç–æ –≥–æ—Ç–æ–≤–æ–µ —Ä–µ—à–µ–Ω–∏–µ –¥–ª—è —Ç–∞–∫–∏—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (–ø–æ –∫—Ä–∞–π–Ω–µ–π –º–µ—Ä–µ, —Ç–∞–∫ –≥–æ–≤–æ—Ä—è—Ç –∫–æ–ª–ª–µ–≥–∏), –≤—Ä–æ–¥–µ –∫–∞–∫–æ–≥–æ-—Ç–æ "—Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ–≥–æ –∏–º–µ–Ω–∏" —Ö–æ—Å—Ç–∞
>
> –î–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –º—ã –ø—Ä–∏–ª–æ–∂–∏–ª–∏ "–∑–∞–≥–ª—É—à–∫—É" —Å–µ—Ä–≤–∏—Å–∞ –≤ –∫–∞—Ç–∞–ª–æ–≥–µ `server` (–∑–∞–ø—É—Å–∫–∞—Ç—å —á–µ—Ä–µ–∑ `node server/index.js`)
>
> –ï—Å–ª–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ Frontend'–∞ —Ç—É–¥–∞ –ø—Ä–∏–¥—ë—Ç –∑–∞–ø—Ä–æ—Å, —Ç–æ –≤ –∫–æ–Ω—Å–æ–ª—å —Å–µ—Ä–≤–µ—Ä–∞ –≤—ã–≤–µ–¥–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ: `received request to: /api`
> 
> –°–∞–º —Å–µ—Ä–≤–µ—Ä —É–ø–∞–∫–æ–≤—ã–≤–∞—Ç—å –≤ Docker-–æ–±—Ä–∞–∑ –Ω–µ –Ω—É–∂–Ω–æ
> 
> Frontend –¥–æ–ª–∂–µ–Ω –æ—Ç–¥–∞–≤–∞—Ç—å—Å—è –ø–æ HTTPS (—Ö–æ—Ç—è –º–µ–∂–¥—É Nginx –∏ —Å–µ—Ä–≤–µ—Ä–æ–º –ø–æ–∫–∞ –±—É–¥–µ—Ç HTTP &ndash; –∏–ª–ª—é–∑–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, —á—Ç–æ –ø–æ–¥–µ–ª–∞–µ—à—å üòà), –ø–æ—ç—Ç–æ–º—É:
> 1. –ù–∞ —Å–∞–º Nginx –Ω–∞–¥–æ –ø–æ—Å—Ç–∞–≤–∏—Ç—å —Å–∞–º–æ–ø–æ–¥–ø–∏—Å–∞–Ω–Ω—ã–π —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç, —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è –≤ 1 –º–µ—Å—è—Ü (—Å –¥–∞—Ç—ã —Å–±–æ—Ä–∫–∏ –æ–±—Ä–∞–∑–∞), –≤—ã–¥–∞–Ω–Ω—ã–π –Ω–∞ `localhost` (–ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –ø–æ–ª–æ–∂–∏—Ç—å –≤ `/etc/nginx/keys` –≤ –≤–∏–¥–µ —Ñ–∞–π–ª–æ–≤ `server.key` –∏ `server.crt`, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ)
> 2. –°–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç –≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–º —à–∞–≥–æ–º –≤ —Å–±–æ—Ä–∫–µ —á–µ—Ä–µ–∑ openssl (–Ω—É–∂–µ–Ω RSA 4096 –±–∏—Ç)
> 3. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞—Ç—å –Ω—É–∂–Ω–æ —Ç–æ–ª—å–∫–æ TLS1.3 (–ø–æ–¥–¥–µ—Ä–∂–∫–∞ 1.2 –∏ 1.1 –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è), –≤—ã—Å—Ç–∞–≤—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx
> 4. http –∑–∞–ø—É—Å–∫–∞—Ç—å –Ω–∞ –ø–æ—Ä—Ç—É 8080, https –Ω–∞ 8443, –≤—ã—Å—Ç–∞–≤—å—Ç–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ Nginx
> 3. –†–µ–¥–∏—Ä–µ–∫—Ç–∏—Ç—å —Å http –Ω–∞ https (—Ç.–µ. —Å 8080 –Ω–∞ 8443 –ø–æ—Ä—Ç)
>
> –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è Nginx –¥–æ–ª–∂–Ω–∞ —Ä–∞—Å–ø–æ–ª–∞–≥–∞—Ç—å—Å—è –≤ —Ñ–∞–π–ª–µ `nginx.conf.template` –∏ –∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ `/etc/nginx/templates/default.conf.template`, –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π —Å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–µ–π –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç—å –Ω–µ –Ω—É–∂–Ω–æ

**–í–∞–∂–Ω–æ**: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –æ–±—Ä–∞–∑ –ø–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ (**–Ω–µ production**), –ø–æ—ç—Ç–æ–º—É –±—É–¥–µ–º —Å—á–∏—Ç–∞—Ç—å, —á—Ç–æ —É–ø–∞–∫–æ–≤–∫–∞ –≤ –æ–±—Ä–∞–∑ –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞ –∏ –¥–æ—Å—Ç—É–ø –∫ —Ö–æ—Å—Ç—É –¥–æ–ø—É—Å—Ç–∏–º—ã

–ß—Ç–æ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å:
> 1. –£–ø–∞–∫–æ–≤–∞—Ç—å Frontend –≤ Docker-–æ–±—Ä–∞–∑, –ø—Ä–∏ —ç—Ç–æ–º —Ä–∞—Å–ø–∞—Ä—Ä–∞–ª–µ–ª–∏—Ç—å:
> - —Å–±–æ—Ä–∫—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
> - —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (–ª–∏–Ω—Ç–∏–Ω–≥ –Ω–µ –Ω—É–∂–µ–Ω)
> - –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –ø—Ä–∏–≤–∞—Ç–Ω–æ–≥–æ –∫–ª—é—á–∞—è –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–∞ (–±–µ—Ä–∏—Ç–µ –æ–±—Ä–∞–∑ Ubuntu LTS)
> 2. –í—ã–ª–æ–∂–∏—Ç—å –≤—Å—ë –≤ –≤–∏–¥–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ –æ–±—Ä–∞–∑–∞ –Ω–∞ GHCR (GitHub Container Registry), —á—Ç–æ–±—ã –º—ã –º–æ–≥–ª–∏ —Å–∞–º–∏ –∑–∞—Ç–µ—Å—Ç–∏—Ç—å –∏ –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

–ß–µ–≥–æ –Ω–µ –Ω—É–∂–Ω–æ –¥–µ–ª–∞—Ç—å (–¥–æ—Å–ª–æ–≤–Ω–æ):
> –ù–∏–∫–∞–∫–∏—Ö `entrypoint.sh` –∏ –¥—Ä—É–≥–∏—Ö sh-—Å–∫—Ä–∏–ø—Ç–æ–≤ –ø–∏—Å–∞—Ç—å –Ω–µ –Ω—É–∂–Ω–æ
> 
> –ü–µ—Ä–µ–¥–µ–ª—ã–≤–∞—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∏—Å—Ö–æ–¥–Ω—ã–π –∫–æ–¥) —Ç–æ–∂–µ –Ω–µ –Ω—É–∂–Ω–æ

### –¢—Ä–µ–±–æ–≤–∞–Ω–∏—è

1. –í—Å—ë –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –æ—Ñ–æ—Ä–º–ª–µ–Ω–æ –≤ –≤–∏–¥–µ –ø—É–±–ª–∏—á–Ω–æ–≥–æ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è –Ω–∞ GitHub
2. –í—Å—è —Å–±–æ—Ä–∫–∞ –æ–±—Ä–∞–∑–æ–≤ –¥–æ–ª–∂–Ω–∞ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ GitHub Actions
3. –û–±—Ä–∞–∑ –¥–æ–ª–∂–µ–Ω –≤—ã–∫–ª–∞–¥—ã–≤–∞—Ç—å—Å—è –≤ GitHub Container Registry (GHCR)

–ö —Ç–µ–∫—É—â–µ–º—É –∑–∞–¥–∞–Ω–∏—é –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ –ø—Ä–µ–¥—ä—è–≤–ª—è—é—Ç—Å—è —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è:
1. [Docker Buildx Build](https://docs.docker.com/build/) (—É–∫–∞–∑—ã–≤–∞–π—Ç–µ —è–≤–Ω–æ –ø—Ä–∏ —Å–±–æ—Ä–∫–µ `docker buildx build`)
2. Multi-Stage
